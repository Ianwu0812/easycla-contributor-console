{"ast":null,"code":"import { CLAManagersModel } from 'src/app/core/models/cla-manager';\nimport { AppSettings } from 'src/app/config/app-settings';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"src/app/shared/services/storage.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"src/app/core/services/cla-contributor.service\";\nimport * as i6 from \"src/app/shared/services/alert.service\";\nimport * as i7 from \"../../../../shared/components/project-title/project-title.component\";\nimport * as i8 from \"../../../../shared/components/checkbox/checkbox.component\";\nfunction ClaRequestAuthorizationComponent_div_15_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.claManagerError);\n  }\n}\nfunction ClaRequestAuthorizationComponent_div_15_div_2_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵelementStart(1, \"app-checkbox\", 26);\n    i0.ɵɵlistener(\"checkboxEmitter\", function ClaRequestAuthorizationComponent_div_15_div_2_div_5_Template_app_checkbox_checkboxEmitter_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const manager_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(3);\n      return ctx_r7.onClickCheckbox($event, manager_r6);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const manager_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"checked\", manager_r6.hasChecked)(\"text\", manager_r6.name);\n  }\n}\nfunction ClaRequestAuthorizationComponent_div_15_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵelementStart(2, \"app-checkbox\", 22);\n    i0.ɵɵlistener(\"checkboxEmitter\", function ClaRequestAuthorizationComponent_div_15_div_2_Template_app_checkbox_checkboxEmitter_2_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.onClickSelectAll($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"div\", 23);\n    i0.ɵɵelementStart(4, \"div\", 24);\n    i0.ɵɵtemplate(5, ClaRequestAuthorizationComponent_div_15_div_2_div_5_Template, 2, 2, \"div\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r4.hasSelectAll);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.managers.list);\n  }\n}\nfunction ClaRequestAuthorizationComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, ClaRequestAuthorizationComponent_div_15_div_1_Template, 2, 1, \"div\", 17);\n    i0.ɵɵtemplate(2, ClaRequestAuthorizationComponent_div_15_div_2_Template, 6, 2, \"div\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.managers.list);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.managers.list);\n  }\n}\nfunction ClaRequestAuthorizationComponent_ng_template_29_i_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 37);\n  }\n}\nfunction ClaRequestAuthorizationComponent_ng_template_29_i_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 38);\n  }\n}\nfunction ClaRequestAuthorizationComponent_ng_template_29_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 35);\n    i0.ɵɵelementStart(1, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function ClaRequestAuthorizationComponent_ng_template_29_div_9_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return ctx_r15.goback();\n    });\n    i0.ɵɵtext(2, \" Go Back \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClaRequestAuthorizationComponent_ng_template_29_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵelementStart(1, \"div\", 28);\n    i0.ɵɵelementStart(2, \"div\", 29);\n    i0.ɵɵelementStart(3, \"div\", 11);\n    i0.ɵɵtemplate(4, ClaRequestAuthorizationComponent_ng_template_29_i_4_Template, 1, 0, \"i\", 30);\n    i0.ɵɵtemplate(5, ClaRequestAuthorizationComponent_ng_template_29_i_5_Template, 1, 0, \"i\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 32);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"p\", 33);\n    i0.ɵɵtemplate(9, ClaRequestAuthorizationComponent_ng_template_29_div_9_Template, 3, 0, \"div\", 34);\n    i0.ɵɵelementStart(10, \"div\", 35);\n    i0.ɵɵelementStart(11, \"button\", 36);\n    i0.ɵɵlistener(\"click\", function ClaRequestAuthorizationComponent_ng_template_29_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.closeModal();\n    });\n    i0.ɵɵtext(12, \" Exit EasyCLA \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r2.hasError);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.hasError);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.title);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"innerHTML\", ctx_r2.message, i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.hasError);\n  }\n}\nexport let ClaRequestAuthorizationComponent = /*#__PURE__*/(() => {\n  class ClaRequestAuthorizationComponent {\n    constructor(route, router, modalService, storageService, location, claContributorService, alertService) {\n      this.route = route;\n      this.router = router;\n      this.modalService = modalService;\n      this.storageService = storageService;\n      this.location = location;\n      this.claContributorService = claContributorService;\n      this.alertService = alertService;\n      this.managers = new CLAManagersModel();\n      this.projectId = this.route.snapshot.paramMap.get('projectId');\n      this.userId = this.route.snapshot.paramMap.get('userId');\n      this.location.onPopState(() => this.modalService.dismissAll());\n    }\n    ngOnInit() {\n      this.hasSelectAll = false;\n      this.claManagerError = 'Wait... we are loading CLA manager(s).';\n      this.company = JSON.parse(this.storageService.getItem(AppSettings.SELECTED_COMPANY));\n      if (this.company) {\n        this.selectedCompany = this.company.companyID;\n        this.getCLAManagers();\n      }\n    }\n    onClickBack() {\n      this.modalService.dismissAll();\n      const url = '/corporate-dashboard/' + this.projectId + '/' + this.userId;\n      this.router.navigate([url]);\n    }\n    onClickSelectAll(status) {\n      this.hasSelectAll = status;\n      this.managers.list.map(manager => manager.hasChecked = status);\n    }\n    onClickCheckbox(status, manager) {\n      manager.hasChecked = status;\n      if (!manager.hasChecked) {\n        this.hasSelectAll = status;\n      }\n      if (this.hasAllManagerChecked()) {\n        this.hasSelectAll = true;\n      }\n    }\n    hasAllManagerChecked() {\n      for (const manager of this.managers.list) {\n        if (!manager.hasChecked) {\n          return false;\n        }\n      }\n      return true;\n    }\n    getSelectedCLAManagers() {\n      const list = [];\n      if (this.managers) {\n        for (const manager of this.managers.list) {\n          if (manager.hasChecked) {\n            list.push({\n              email: manager.email,\n              name: manager.name\n            });\n          }\n        }\n      }\n      return list;\n    }\n    onClickRequestAuthorization(content) {\n      this.alertService.clearAlert();\n      if (this.getSelectedCLAManagers().length > 0) {\n        this.notifyCLAManagers(content);\n      } else {\n        this.alertService.error('Please select at least one CLA Manager.');\n      }\n    }\n    notifyCLAManagers(content) {\n      const project = JSON.parse(this.storageService.getItem(AppSettings.PROJECT));\n      const data = {\n        companyName: this.company.companyName,\n        claGroupID: project.project_id,\n        userID: this.userId,\n        list: this.getSelectedCLAManagers()\n      };\n      this.claContributorService.notifyCLAMangers(data).subscribe(() => {\n        this.hasError = false;\n        this.title = 'Request Submitted';\n        this.message = 'The CLA Manager for <b>' + this.company.companyName + '</b> will be notified of your request to be authorized for contributions.' + ' You will be notified via email when the status has been approved or rejected.';\n        this.showDialogModal(content);\n        this.hasSelectAll = false;\n        this.managers.list.map(manager => manager.hasChecked = false); // Reset checkbox.\n      }, () => {\n        this.hasError = true;\n        this.title = 'Request Failed';\n        this.message = 'A request has been failed due to some technical error please contact your administrator';\n        this.showDialogModal(content);\n      });\n    }\n    exitEasyCLA() {\n      const redirectUrl = JSON.parse(this.storageService.getItem(AppSettings.REDIRECT));\n      if (redirectUrl !== null) {\n        window.open(redirectUrl, '_self');\n      } else {\n        const error = 'Unable to fetch redirect URL.';\n        this.alertService.error(error);\n      }\n    }\n    closeModal() {\n      this.modalService.dismissAll();\n      const redirectUrl = JSON.parse(this.storageService.getItem(AppSettings.REDIRECT));\n      if (redirectUrl !== null) {\n        window.open(redirectUrl, '_self');\n      } else {\n        const error = 'Unable to fetch redirect URL.';\n        this.alertService.error(error);\n      }\n    }\n    goback() {\n      this.modalService.dismissAll();\n    }\n    getCLAManagers() {\n      this.claContributorService.getProjectCLAManagers(this.projectId, this.selectedCompany).subscribe(response => {\n        this.managers = response;\n        if (this.managers && !this.managers.list) {\n          this.claManagerError = 'No CLA manager found.';\n        }\n      }, exception => {\n        this.claContributorService.handleError(exception);\n      });\n    }\n    showDialogModal(content) {\n      this.modalService.open(content, {\n        centered: true,\n        backdrop: 'static',\n        keyboard: false\n      });\n    }\n  }\n  ClaRequestAuthorizationComponent.ɵfac = function ClaRequestAuthorizationComponent_Factory(t) {\n    return new (t || ClaRequestAuthorizationComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.NgbModal), i0.ɵɵdirectiveInject(i3.StorageService), i0.ɵɵdirectiveInject(i4.PlatformLocation), i0.ɵɵdirectiveInject(i5.ClaContributorService), i0.ɵɵdirectiveInject(i6.AlertService));\n  };\n  ClaRequestAuthorizationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ClaRequestAuthorizationComponent,\n    selectors: [[\"app-cla-request-authorization\"]],\n    decls: 31,\n    vars: 3,\n    consts: [[3, \"projectId\", \"userId\"], [1, \"col-12\", \"corporate-dashboard\"], [1, \"container\"], [1, \"row\", \"justify-content-center\", \"align-items-center\"], [1, \"col-xs-11\", \"col-sm-11\", \"col-md-11\", \"col-lg-8\", \"select-company-model\"], [1, \"col-12\", \"header\"], [1, \"sub-header\"], [1, \"col-12\", \"body\"], [1, \"col-8\", \"cla-managers-container\"], [\"class\", \"col-12\", 4, \"ngIf\"], [1, \"col-12\", \"buttons\"], [1, \"col-auto\"], [\"tabindex\", \"-1\", \"type\", \"button\", 1, \"btn\", \"active\", 3, \"click\"], [1, \"col-xs-6\", \"col-sm-6\", \"col-md-4\", \"col-lg-3\"], [\"tabindex\", \"-1\", \"type\", \"button\", 1, \"btn\", 3, \"click\"], [\"successModal\", \"\"], [1, \"col-12\"], [\"class\", \"col-12 error\", 4, \"ngIf\"], [\"class\", \"col-12 manager-list\", 4, \"ngIf\"], [1, \"col-12\", \"error\"], [1, \"col-12\", \"manager-list\"], [1, \"item\"], [\"text\", \"Select All\", 3, \"checked\", \"checkboxEmitter\"], [1, \"separator\"], [1, \"scrollable\"], [\"class\", \"item\", 4, \"ngFor\", \"ngForOf\"], [3, \"checked\", \"text\", \"checkboxEmitter\"], [1, \"model\"], [1, \"modal-body\"], [1, \"row\", \"justify-content-center\", \"success-dialog\"], [\"class\", \"fas fa-check-circle logo green\", 4, \"ngIf\"], [\"class\", \"fas fa-exclamation-circle logo red\", 4, \"ngIf\"], [1, \"col-12\", \"title\"], [1, \"col-11\", \"success-message\", 3, \"innerHTML\"], [\"class\", \"col-4\", 4, \"ngIf\"], [1, \"col-4\"], [\"tabindex\", \"-1\", \"type\", \"button\", 1, \"success-btn\", 3, \"click\"], [1, \"fas\", \"fa-check-circle\", \"logo\", \"green\"], [1, \"fas\", \"fa-exclamation-circle\", \"logo\", \"red\"], [\"tabindex\", \"-1\", \"type\", \"button\", 1, \"success-btn\", \"go-back\", 3, \"click\"]],\n    template: function ClaRequestAuthorizationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r19 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelement(0, \"app-project-title\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵtext(6, \" Request Authorization to Contribute \");\n        i0.ɵɵelementStart(7, \"div\", 6);\n        i0.ɵɵtext(8, \" A CLA Manager from your organization must authorize you to contribute to this project \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 7);\n        i0.ɵɵelementStart(10, \"div\", 3);\n        i0.ɵɵelementStart(11, \"div\", 8);\n        i0.ɵɵelementStart(12, \"div\", 3);\n        i0.ɵɵelementStart(13, \"div\", 5);\n        i0.ɵɵtext(14, \"CLA Manager(s) for your Organization \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(15, ClaRequestAuthorizationComponent_div_15_Template, 3, 2, \"div\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 10);\n        i0.ɵɵelementStart(17, \"div\", 3);\n        i0.ɵɵelementStart(18, \"div\", 11);\n        i0.ɵɵelementStart(19, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function ClaRequestAuthorizationComponent_Template_button_click_19_listener() {\n          i0.ɵɵrestoreView(_r19);\n          const _r1 = i0.ɵɵreference(30);\n          return ctx.onClickRequestAuthorization(_r1);\n        });\n        i0.ɵɵtext(20, \" Request Authorization \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 10);\n        i0.ɵɵelementStart(22, \"div\", 3);\n        i0.ɵɵelementStart(23, \"div\", 13);\n        i0.ɵɵelementStart(24, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function ClaRequestAuthorizationComponent_Template_button_click_24_listener() {\n          return ctx.onClickBack();\n        });\n        i0.ɵɵtext(25, \" Go Back \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 13);\n        i0.ɵɵelementStart(27, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function ClaRequestAuthorizationComponent_Template_button_click_27_listener() {\n          return ctx.exitEasyCLA();\n        });\n        i0.ɵɵtext(28, \" Exit EasyCLA \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(29, ClaRequestAuthorizationComponent_ng_template_29_Template, 13, 5, \"ng-template\", null, 15, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"projectId\", ctx.projectId)(\"userId\", ctx.userId);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngIf\", ctx.managers);\n      }\n    },\n    directives: [i7.ProjectTitleComponent, i4.NgIf, i8.CheckboxComponent, i4.NgForOf],\n    styles: [\".corporate-dashboard[_ngcontent-%COMP%]{padding:45px 0;background-color:#f5f5f5}.corporate-dashboard[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{font-size:16px;color:#fff;font-weight:bold;border-radius:5px;background:#0099cc;padding:10px 15px;text-align:center}.corporate-dashboard[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .sub-header[_ngcontent-%COMP%]{font-size:12px;font-weight:normal;margin:5px 0 3px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{background-color:#fff;color:#8492a6;padding:25px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]{border:1px solid #bdbdbd;border-radius:10px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{font-size:14px;height:40px;background:#0099cc;border:0px solid #0099cc;color:#fff;border-radius:5px;text-align:left;width:100%}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{padding:10px 0 10px 14px;text-align:left;font-size:12px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .manager-list[_ngcontent-%COMP%]{margin-bottom:10px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .manager-list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border:1px solid #e0e0e0;margin-top:10px;width:100%}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .manager-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding-top:10px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cla-managers-container[_ngcontent-%COMP%]   .manager-list[_ngcontent-%COMP%]   .scrollable[_ngcontent-%COMP%]{height:90px;overflow-y:auto}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{margin-top:30px}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{text-align:center;background:#ffffff;border:1px solid #0099cc;border-radius:20px;color:#09c;font-size:12px;padding:5px 20px;width:100%}.corporate-dashboard[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .btn.active[_ngcontent-%COMP%]{background:#0099cc!important;color:#fff}\"]\n  });\n  return ClaRequestAuthorizationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}